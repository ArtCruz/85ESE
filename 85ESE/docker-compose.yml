version: '3.8'

services:
  product_api:
    build: ./product_api
    ports:
      - "9090:9090"
    environment:
      - PORT=9090

  images:
    build: ./images
    ports:
      - "9091:9091"
    environment:
      - PORT=9091

  ordem_compra:
    build: ./ordem_compra
    ports:
      - "9092:9092"
    environment:
      - PORT=9092

  gateway:
    build: ./gateway
    ports:
      - "8080:8080"
    environment:
      - PRODUCT_API_URL=http://product_api:9090
      - IMAGES_API_URL=http://images:9091
      - ORDERS_API_URL=http://ordem_compra:9092
      - PORT=8080
    depends_on:
      - product_api
      - images

  frontend:
    build: ./frontend
    ports:
      - "3000:3000"
    environment:
      - REACT_APP_GATEWAY_URL=http://localhost:8080
    depends_on:
      - gateway
